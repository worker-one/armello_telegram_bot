## Armello Telegram Bot

## Введение

Это документация для бота Armello @armello_bot.

## Управление работой бота

Управление работй бота выполняется через панель http://159.89.3.192:8000/ui/services/armello_bot

- Запуск

- Остановка
  
- Перезапуск
  
- Проверка статуса

Доступ предоставляется через API ключ.

Для администратора доступны следующие команды:

- `/update` : обновить статистику на основе данных матчей.
  
- `/customtitle` : управление кастомными титулами.
  
- `/deny <match_id>` : обнуление матча по его id.

- `/hellomessage` : настройка привественноого сообщения.

Чтобы наделить пользователя правами администратора нужно изменить значения `role_id` в базе данных:

таблица `users` -> столбец `role_id` . 

- `1` : администратор
- `2` : пользователь 

## Управление базой данных

Управление базой данных выполняется через DBeaver. 

### Создание копии базы данных (бэкап)

1. Выбрать базу данных, выделить желаемые таблицы для копирования, кликнуть правой кнопкой мыши, нажать на кнопку экспорта

![image](https://github.com/user-attachments/assets/d6a40dfb-1c50-402a-b439-b13a5943c7cf)

2. Выполнить конфигурацию экспорта по скриншотам ниже

![image](https://github.com/user-attachments/assets/a6e0c25e-41af-45c0-8190-e28a442aa141)

![image](https://github.com/user-attachments/assets/30e539ef-dd99-4198-a4a0-fdb8bf7fd32f)

![image](https://github.com/user-attachments/assets/a7fc511e-dcc1-4556-a260-043aab44d4a4)

Здесь выбрать папку для сохранения таблиц.

![image](https://github.com/user-attachments/assets/8c01038a-0fdd-4242-9807-0a95968b558d)

3. Нажать "Proceed"

4. В конце процесса, в указанной папке появятся читаемые файлы в формате .sql , которые определяют скрипт восстановления таблиц с данными.


### Установка существующего содержания базы данных (бэкапа)

1. Выбрать базу данных, кликнуть правой кнопкой мыши, нажать на создание нового SQL скрипта

![image](https://github.com/user-attachments/assets/e42e0051-b623-47ae-9bb7-8377859e8e16)

2. Скопировать скрипт таблицы из файла. Встановить данный скрипт в окно редактора, запустить скрипт.

![image](https://github.com/user-attachments/assets/2c9a3646-1872-4cb0-97e6-be126e270c60)

3. После завершения работы скрипта, таблица будет восстановлена.

![image](https://github.com/user-attachments/assets/93273c50-2107-4e3c-9f72-9a0e34ea1beb)

Важно: перед загрузкой данных таблицы необходимо очистить уже существующую таблицу через Truncate (см. ниже) 

### Удаление (вайп) базы данных

1. Выделите таблицы, которые нужно вайпнуть (все таблицы отвечающие за статистику: `matches` и `match_participants`)

2. Кликнуть правой кнопкой мыши, выбрать Tools -> Truncate

![image](https://github.com/user-attachments/assets/0fd37394-8a66-431a-b064-a697ea4d46f0)

3. Выделить "Cascade"

4. Нажать Proceed

![image](https://github.com/user-attachments/assets/fdcc4f8c-6bfd-4ed0-b495-8b101e874565)

5. Для построения новых рейтингов и титулов прописать в боте команду `/update`



